import{r as V,h as B,_ as Q,o as l,c,b as v,g as R,n as S,f as g,F as k,D as H,k as y,w as e,a as s,t as w,d,e as O,i as G,p as X,m as Y,q as W,G as I,u as D,l as ee,y as te,s as T,z as se,x as j,O as A,Z as le,M as L}from"./app.172b2de0.js";import{u as ae}from"./useNotifications.fe41dfa4.js";import{l as N}from"./helpers.3f1a4003.js";import{_ as oe}from"./PageHeader.5206c81b.js";import{_ as U,a as ne,C as ie,b as ce}from"./PostsFilter.9a5cdfb3.js";import{T as re,_ as P}from"./Tab.59fd00ff.js";import{_ as ue}from"./Panel.52ba92d7.js";import{_ as q}from"./Checkbox.ca6d65f4.js";import{_ as de,a as me}from"./PureDangerButton.a5bf5551.js";import{b as fe,d as pe,_ as ve,T as _e,c as he}from"./Trash.0f8df249.js";import{u as ge}from"./SearchInput.314b6f94.js";import{_ as ye,a as be}from"./NoResult.3b14c343.js";import{_ as F,d as $e,c as ke,b as xe,a as we}from"./VerticallyScrollableContent.29d50f08.js";import{_ as E}from"./Account.d771f234.js";import"./EllipsisVertical.ad50047d.js";import"./PrimaryButton.a873fded.js";import"./ProviderIcon.58df7758.js";import"./Input.c7303889.js";import"./ExclamationCircle.962a476a.js";import"./Alert.78c7be06.js";const Ce=()=>{const t=V([]),a=V([]),u=B({get(){return x(t.value)},set(){const o=t.value;if(x(o)){b(o);return}f(o)}}),m=o=>{t.value=o},f=o=>{for(const n of o)$(n)||a.value.push(n)},i=o=>{let n=a.value.indexOf(o);n!==-1&&a.value.splice(n,1)},b=o=>{for(const n of o)i(n)},C=()=>{a.value=[]},$=o=>a.value.includes(o),x=o=>o.length?o.every(n=>$(n)):!1;return{selectedRecords:a,toggleSelectRecordsOnPage:u,putPageRecords:m,deselectRecord:i,deselectAllRecords:C}},De={},Re={class:"flex flex-col overflow-x-hidden overflow-y-hidden"},Se={class:"-m-1.5 overflow-x-auto"},Pe={class:"p-1.5 min-w-full inline-block align-middle overflow-hidden"},Oe={class:"min-w-full divide-y divide-gray-200 border-collapse"},Ve={class:"divide-y divide-gray-100"};function Be(t,a){return l(),c("div",Re,[v("div",Se,[v("div",Pe,[v("table",Oe,[v("thead",null,[R(t.$slots,"head")]),v("tbody",Ve,[R(t.$slots,"body")])])])])])}const Ne=Q(De,[["render",Be]]),Z={__name:"TableRow",props:{hoverable:{type:Boolean,default:!1}},setup(t){return(a,u)=>(l(),c("tr",{class:S({"bg-white hover:bg-gray-50 transition-colors ease-in-out duration-200":t.hoverable})},[R(a.$slots,"default")],2))}},Ie=["scope"],Te=["role"],z="px-lg py-sm",h={__name:"TableCell",props:{component:{type:String,default:"td"},scope:{type:String},class:{type:String},align:{type:String,default:"left"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(t){const a=t,u=B(()=>({left:"text-left",right:"text-right"})[a.align]);return(m,f)=>(l(),c(k,null,[t.component==="th"?(l(),c("th",{key:0,scope:t.scope,class:S([[a.class,u.value,z],"font-medium"])},[R(m.$slots,"default")],10,Ie)):g("",!0),t.component==="td"?(l(),c("td",{key:1,class:S([a.class,u.value,z]),onClick:f[0]||(f[0]=()=>{t.clickable&&m.$emit("click")}),role:t.clickable?"button":"cell"},[R(m.$slots,"default")],10,Te)):g("",!0)],64))}},je={class:"w-44"},Ae={key:0,class:"text-sm mt-xs text-gray-500"},Le={key:1,class:"text-sm mt-xs text-gray-500"},Ue={class:"w-96 text-left break-words"},qe={key:0,class:"w-48 flex relative"},Fe={key:0,class:"absolute top-0 -right-5 z-10"},Ee={class:"flex flex-wrap gap-xs"},ze={class:"flex gap-xs"},Me={class:"mr-xs"},He={class:"text-left"},Ge={class:"mr-xs flex items-center"},We={__name:"PostItem",props:{item:{type:Object,required:!0},filter:{type:Object,default:{accounts:[]}}},setup(t){const a=t,{getOriginalVersion:u,getAccountVersion:m}=ge(),f=B(()=>{if(!a.item.versions.length)return{excerpt:"",media:null,media_count:0};let $=a.item.accounts;a.filter.accounts.length&&($=$.filter(n=>a.filter.accounts.includes(n.id)));const x=$.map(n=>{const _=m(a.item.versions,n.id);return _?_.content[0]:u(a.item.versions).content[0]}),o=x.length?x[0]:a.item.versions[0].content[0];return{excerpt:o.excerpt,media:o.media.length?o.media[0]:null,media_count:o.media.length}}),i=V(!1),b=()=>{i.value=!0},C=()=>{i.value=!1};return($,x)=>{const o=H("tooltip");return l(),y(Z,{hoverable:!0},{default:e(()=>[s(h,{class:"w-10"},{default:e(()=>[R($.$slots,"checkbox")]),_:3}),s(h,{clickable:!0,onClick:b},{default:e(()=>[v("div",je,[s(F,{value:t.item.status},null,8,["value"]),t.item.status==="SCHEDULED"?(l(),c("div",Ae,w(t.item.scheduled_at.human),1)):g("",!0),t.item.status==="PUBLISHED"?(l(),c("div",Le,w(t.item.published_at.human),1)):g("",!0)])]),_:1}),s(h,{clickable:!0,onClick:b,class:"!pl-0"},{default:e(()=>[v("div",Ue,w(f.value.excerpt),1)]),_:1}),s(h,{clickable:!0,onClick:b},{default:e(()=>[f.value.media?(l(),c("div",qe,[f.value.media?(l(),y(ye,{key:0,media:f.value.media,"img-height":"sm",imgWidthFull:!1},{default:e(()=>[f.value.media_count>1?(l(),c("div",Fe,[s($e,null,{default:e(()=>[d("+"+w(f.value.media_count-1),1)]),_:1})])):g("",!0)]),_:1},8,["media"])):g("",!0)])):g("",!0)]),_:1}),s(h,{clickable:!0,onClick:b},{default:e(()=>[v("div",Ee,[(l(!0),c(k,null,O(t.item.tags,n=>(l(),y(ke,{key:n.id,item:n,removable:!1,editable:!1},null,8,["item"]))),128))])]),_:1}),s(h,null,{default:e(()=>[v("div",ze,[(l(!0),c(k,null,O(t.item.accounts.slice(0,3),(n,_)=>(l(),c("div",{key:n.id,class:S({"-ml-6":_>0})},[G(s(E,{provider:n.provider,"img-url":n.image,active:!0},null,8,["provider","img-url"]),[[o,n.name]])],2))),128)),t.item.accounts.length>3?(l(),y(X,{key:0,"width-classes":"w-64",placement:"bottom-end"},{trigger:e(()=>[s(fe,{class:"mt-4 font-semibold"},{default:e(()=>[d("+"+w(t.item.accounts.slice(3).length),1)]),_:1})]),content:e(()=>[s(xe,null,{default:e(()=>[(l(!0),c(k,null,O(t.item.accounts.slice(3),n=>(l(),y(Y,{as:"div"},{default:e(()=>[v("span",Me,[s(E,{provider:n.provider,"img-url":n.image,active:!0},null,8,["provider","img-url"])]),v("span",He,w(n.name),1)]),_:2},1024))),256))]),_:1})]),_:1})):g("",!0)])]),_:1}),s(h,null,{default:e(()=>[s(U,{"item-id":t.item.id},null,8,["item-id"])]),_:1}),s(pe,{show:i.value,scrollableBody:!0,onClose:C},{body:e(()=>[s(F,{value:t.item.status,class:"mb-lg"},null,8,["value"]),i.value?(l(),y(we,{key:0,accounts:t.item.accounts,versions:t.item.versions},null,8,["accounts","versions"])):g("",!0)]),footer:e(()=>[i.value?(l(),c(k,{key:0},[v("div",Ge,[s(U,{"item-id":t.item.id},null,8,["item-id"])]),s(W,{onClick:C},{default:e(()=>[d("Close")]),_:1})],64)):g("",!0)]),_:1},8,["show"])]),_:3})}}},Ze={class:"bg-white border border-gray-100 rounded-lg p-sm w-fit"},Je={class:"flex flex-wrap items-center space-x-1"},M="px-sm py-xs rounded-md leading-4",Ke={__name:"Pagination",props:{meta:{type:Object,default:{current_page:1,from:1,last_page:1,per_page:2,to:1,total:0,links:[]}},links:{type:Object,default:{first:null,last:null,next:null,prev:null}}},setup(t){const a=t,u=B(()=>a.meta.links.map(m=>{const f=m.label.replace("&laquo; ","").replace(" &raquo;","");return{active:m.active,url:m.url,label:f,component:isNaN(parseInt(m.label))?{Next:ne,Previous:ie}[f]:null}}));return(m,f)=>(l(),c("div",Ze,[v("div",Je,[(l(!0),c(k,null,O(u.value,(i,b)=>(l(),c(k,null,[i.url===null?(l(),c("div",{key:b,class:S([[M,{"!px-0":i.label==="...","!px-xs":i.component}],"text-gray-400"])},[i.component?(l(),y(I(i.component),{key:0})):(l(),c(k,{key:1},[d(w(i.label),1)],64))],2)):(l(),y(D(ee),{key:`link-${b}`,disabled:"",class:S(["transition-colors ease-in-out duration-200",[M,{"bg-indigo-500 text-white":i.active,"hover:text-indigo-500 focus:text-indigo-500":!i.active,"!px-xs":i.component}]]),href:i.url},{default:e(()=>[i.component?(l(),y(I(i.component),{key:0})):(l(),c(k,{key:1},[d(w(i.label),1)],64))]),_:2},1032,["class","href"]))],64))),256))])]))}},Qe={class:"row-py mb-2xl"},Xe={class:"w-full row-px"},Ye={class:"w-full row-px mt-lg"},et={key:0,class:"mt-lg"},$t={__name:"Index",props:{filter:{type:Object,default:{}},posts:{type:Object},has_failed_posts:{type:Boolean,default:!1}},setup(t){const a=t,u=V({keyword:a.filter.keyword,status:a.filter.status,tags:a.filter.tags,accounts:a.filter.accounts}),{selectedRecords:m,putPageRecords:f,toggleSelectRecordsOnPage:i,deselectRecord:b,deselectAllRecords:C}=Ce(),$=()=>a.posts.data.map(_=>_.id);te(()=>{f($()),T.on("postDelete",_=>{b(_)})}),se(()=>{T.off("postDelete")}),j(()=>N.exports.cloneDeep(u.value),N.exports.throttle(()=>{A.get(route("mixpost.posts.index"),N.exports.pickBy(u.value),{preserveState:!0,only:["posts","filter"]})},300)),j(()=>a.posts.data,()=>{f($())});const{notify:x}=ae(),o=V(!1),n=()=>{A.delete(route("mixpost.posts.multipleDelete"),{data:{posts:m.value,status:u.value.status},onSuccess(){C(),x("success","Selected posts deleted")},onFinish(){o.value=!1}})};return(_,r)=>{const J=H("tooltip");return l(),c(k,null,[s(D(le),{title:"Posts"}),v("div",Qe,[s(oe,{title:"Posts"},{default:e(()=>[s(ce,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=p=>u.value=p),class:"ml-2"},null,8,["modelValue"])]),_:1}),v("div",Xe,[s(re,null,{default:e(()=>[s(P,{onClick:r[1]||(r[1]=p=>u.value.status=null),active:!_.$page.props.filter.status},{default:e(()=>[d("All")]),_:1},8,["active"]),s(P,{onClick:r[2]||(r[2]=p=>u.value.status="draft"),active:_.$page.props.filter.status==="draft"},{default:e(()=>[d("Drafts")]),_:1},8,["active"]),s(P,{onClick:r[3]||(r[3]=p=>u.value.status="scheduled"),active:_.$page.props.filter.status==="scheduled"},{default:e(()=>[d("Scheduled")]),_:1},8,["active"]),s(P,{onClick:r[4]||(r[4]=p=>u.value.status="published"),active:_.$page.props.filter.status==="published"},{default:e(()=>[d("Published")]),_:1},8,["active"]),t.has_failed_posts?(l(),y(P,{key:0,onClick:r[5]||(r[5]=p=>u.value.status="failed"),active:_.$page.props.filter.status==="failed",class:"text-red-500"},{default:e(()=>[d("Failed")]),_:1},8,["active"])):g("",!0)]),_:1})]),v("div",Ye,[s(de,{count:D(m).length,onClose:D(C)},{default:e(()=>[G((l(),y(me,{onClick:r[6]||(r[6]=p=>o.value=!0)},{default:e(()=>[s(_e)]),_:1})),[[J,"Delete"]])]),_:1},8,["count","onClose"]),s(ue,{"with-padding":!1},{default:e(()=>[s(Ne,null,{head:e(()=>[s(Z,null,{default:e(()=>[s(h,{component:"th",scope:"col",class:"w-10"},{default:e(()=>[s(q,{checked:D(i),"onUpdate:checked":r[7]||(r[7]=p=>L(i)?i.value=p:null),disabled:!t.posts.meta.total},null,8,["checked","disabled"])]),_:1}),s(h,{component:"th",scope:"col",class:"w-44"},{default:e(()=>[d("Status")]),_:1}),s(h,{component:"th",scope:"col",class:"!pl-0 text-left"},{default:e(()=>[d("Content")]),_:1}),s(h,{component:"th",scope:"col",class:"w-48"},{default:e(()=>[d("Media")]),_:1}),s(h,{component:"th",scope:"col"},{default:e(()=>[d("Labels")]),_:1}),s(h,{component:"th",scope:"col"},{default:e(()=>[d("Accounts")]),_:1}),s(h,{component:"th",scope:"col"})]),_:1})]),body:e(()=>[(l(!0),c(k,null,O(t.posts.data,p=>(l(),y(We,{key:p.id,item:p,filter:t.posts.filter,onOnDelete:()=>{D(b)(p.id)}},{checkbox:e(()=>[s(q,{checked:D(m),"onUpdate:checked":r[8]||(r[8]=K=>L(m)?m.value=K:null),value:p.id,number:""},null,8,["checked","value"])]),_:2},1032,["item","filter","onOnDelete"]))),128))]),_:1}),t.posts.meta.total?g("",!0):(l(),y(be,{key:0,class:"py-md px-md"},{default:e(()=>[d("No posts found.")]),_:1}))]),_:1}),t.posts.meta.links.length>3?(l(),c("div",et,[s(Ke,{meta:t.posts.meta,links:t.posts.links},null,8,["meta","links"])])):g("",!0)])]),s(ve,{show:o.value,variant:"danger",onClose:r[10]||(r[10]=p=>o.value=!1)},{header:e(()=>[d(" Delete posts ")]),body:e(()=>[d(" Are you sure you want to delete selected posts? ")]),footer:e(()=>[s(W,{onClick:r[9]||(r[9]=p=>o.value=!1),class:"mr-xs"},{default:e(()=>[d("Cancel")]),_:1}),s(he,{onClick:n},{default:e(()=>[d("Delete")]),_:1})]),_:1},8,["show"])],64)}}};export{$t as default};
