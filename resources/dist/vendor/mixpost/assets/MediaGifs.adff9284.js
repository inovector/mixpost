import{r as y,i as O,s as Y,a6 as T,J as re,x as j,y as ie,o as s,c as m,F as P,d as Q,f as A,e as D,t as q,b as C,n as V,l as U,G as ce,g as S,U as H,a7 as M,a as f,a8 as ue,u as e,w as d,_ as X,k as Z,m as ee}from"./app.560f76c3.js";import{_ as E,a as te}from"./NoResult.7510e027.js";import{a as de,_ as se}from"./SearchInput.9d783ea7.js";import{_ as le}from"./Alert.05947b64.js";import{a as ne}from"./PrimaryButton.958f08c1.js";import{u as fe}from"./useNotifications.f087f71b.js";import{l as ae,k as me}from"./helpers.faaf7676.js";const W=(l="mixpost.media.fetchUploads")=>{const{notify:a}=fe(),o=y("uploads"),c=O(()=>({uploads:"Upload",stock:"Stock Photos",gifs:"GIFs"})),_=y(!1),v=y(!1),h=y(!1),w=y(1),k=y([]),x=y(null),n=y(""),p=y([]),u=b=>{const g=p.value.findIndex(t=>t.id===b.id);g<0&&!b.hasOwnProperty("error")&&p.value.push(b),g>=0&&p.value.splice(g,1)},I=()=>{p.value=[]},$=b=>p.value.findIndex(t=>t.id===b.id)!==-1,i=(b=!0)=>{!w.value||(T.start(),axios.get(route(l),{params:{page:w.value,keyword:n.value}}).then(function(g){const t=g.data.links.next;t&&(w.value=g.data.links.next.split("?page=")[1]),t||(w.value=0),b||(k.value=g.data.data),b&&(k.value=[...k.value,...g.data.data])}).catch(()=>{a("error","Error retrieving media. Try again!")}).finally(()=>{T.done(),_.value=!0}))},F=(b,g)=>{v.value=!0,T.start(),axios.post(route("mixpost.media.download"),{items:b}).then(t=>{g(t)}).catch(()=>{a("error","Error downloading media. Try again!")}).finally(()=>{v.value=!1,T.done(),T.remove()})},B=b=>{k.value=k.value.filter(g=>!b.includes(g.id))},G=(b,g)=>{h.value=!0,T.start(),axios.delete(route("mixpost.media.delete"),{data:{items:b}}).then(()=>{g()}).catch(()=>{a("error","Error deleting media. Try again!")}).finally(()=>{h.value=!1,T.done(),T.remove()})},z=()=>{const b=new IntersectionObserver(g=>{g[0].isIntersecting&&i()});re(()=>{b.observe(x.value)})};return Y(n,ae.exports.debounce(()=>{w.value=1,i(!1)},300)),{activeTab:o,tabs:c,isLoaded:_,isDownloading:v,isDeleting:h,keyword:n,page:w,items:k,endlessPagination:x,selected:p,downloadExternal:F,deletePermanently:G,removeItems:B,createObserver:z,toggleSelect:u,deselectAll:I,isSelected:$}};let ve=(l=21)=>crypto.getRandomValues(new Uint8Array(l)).reduce((a,o)=>(o&=63,o<36?a+=o.toString(36):o<62?a+=(o-26).toString(36).toUpperCase():o>62?a+="-":a+="_",a),"");const pe=["data-column"],J={__name:"Masonry",props:{items:{type:Array,required:!0},columns:{type:Number,default:3}},setup(l){const a=l,o=y(null),c=y([]),_=y(!1);j(()=>{x(),window.addEventListener("resize",v)}),ie(()=>{window.removeEventListener("resize",v)});const v=ae.exports.debounce(()=>{c.value.length!==h().length&&x()},300),h=()=>{let n=a.columns;me().width<=768&&(n=2);const p=[];for(let u=0;u<n;u++)p.push({i:u,indexes:[]});return p},w=n=>{const p=n%c.value.length;c.value[p].indexes.push(n)},k=()=>{for(let n=0;n<a.items.length;n++)w(n)},x=()=>{_.value=!1,c.value.splice(0),c.value.push(...h()),_.value=!0,k()};return Y(()=>a.items,()=>{x()}),(n,p)=>(s(),m("div",{class:V(["flex -m-1",{"opacity-0":!_.value}])},[(s(!0),m(P,null,Q(c.value,(u,I)=>(s(),m("div",{class:"flex flex-col grow basis-0 px-1",key:I},[(s(!0),m(P,null,Q(u.indexes,$=>(s(),m("div",{class:"py-1",key:$,ref_for:!0,ref:`item_${$}`},[A(n.$slots,"default",{item:l.items[$],index:$},()=>[D(q(l.items[$]),1)])]))),128)),C("div",{class:"grow -mt-20 pt-20 min-h-[100px] -z-10",ref_for:!0,ref_key:"bottomRef",ref:o,"data-column":I},null,8,pe)]))),128))],2))}},L={__name:"MediaSelectable",props:{active:{type:Boolean,default:!1}},emits:["click"],setup(l){return(a,o)=>(s(),m("div",{onClick:o[0]||(o[0]=c=>a.$emit("click")),class:"w-full relative cursor-pointer box-border"},[A(a.$slots,"default"),C("div",{class:V(["absolute flex items-center justify-center top-0 right-0 mr-sm mt-sm w-7 h-7 rounded-full border border-white",{"bg-indigo-500":l.active,"bg-black bg-opacity-20":!l.active}])},[l.active?(s(),U(ce,{key:0,class:"text-white"})):S("",!0)],2)]))}},ge=["onDrop"],_e={class:"relative flex flex-col justify-center"},he=C("div",{class:"text-center mb-1"},[D("Drag & drop files here, or "),C("label",{for:"browse",class:"cursor-pointer text-indigo-500 hover:text-indigo-700 active:text-indigo-700 focus:outline-none focus:text-indigo-700 transition-colors ease-in-out duration-200"}," Browse ")],-1),ye={class:"text-sm text-gray-400 text-center"},xe=["accept"],be={key:0,class:"mt-lg"},ke={__name:"UploadMedia",props:{maxSelection:{type:Number,default:1},combinesMimeTypes:{type:String,default:""},selected:{type:Array,default:[]},toggleSelect:{type:Function},isSelected:{type:Function},columns:{type:Number,default:3}},emits:["mediaSelect"],setup(l,{emit:a}){const o=l,c=H().props.mixpost.mime_types,_=y(null),v=y(!1),h=t=>{if(x.value)return;v.value=!1;const r=k(t.dataTransfer.files);r.length&&z(r)},w=t=>{const r=k(t.target.files);r.length&&(_.value.value=null,z(r))},k=t=>Array.from(t).filter(r=>c.includes(r.type)),x=y(!1),n=y([]),p=y([]),u=y({});Y(u,()=>{I(),x.value=Object.keys(u.value).length>0});const I=()=>{u.value.handler&&u.value.handler()},$=t=>{n.value.push(t),Object.keys(u.value).length===0&&i()},i=t=>{Object.keys(u.value).length>0&&(G(u.value,t),o.toggleSelect&&o.toggleSelect(t)),n.value.length>0?(F(n.value[0]),B()):F({})},F=t=>{u.value=t},B=()=>{n.value.shift()},G=(t,r)=>{p.value.push(Object.assign(t,{media:r}))},z=t=>{t.forEach(r=>{$({id:ve(),handler:async()=>{await b(r).then(N=>{i(N)}).catch(N=>{i({name:r.name,error:N.response.data.message})})}})})},b=t=>{const r=new FormData;return r.append("file",t),new Promise((N,K)=>{axios.post(route("mixpost.media.upload"),r).then(function(R){N(R.data)}).catch(function(R){K(R)})})},g=O(()=>p.value.filter(()=>!0).reverse());return y([]),(t,r)=>(s(),m(P,null,[C("div",{onDragenter:r[2]||(r[2]=M(N=>v.value=!x.value,["prevent"])),onDrop:M(h,["prevent"]),onDragover:r[3]||(r[3]=M(()=>{},["prevent"])),class:V([{"border-gray-700 bg-white":!v.value,"border-cyan-500 bg-cyan-50":v.value},"relative w-full flex items-center justify-center rounded-lg p-10 border-2 border-dashed transition-colors ease-in-out duration-200"])},[C("div",_e,[v.value?(s(),m("div",{key:0,onDragleave:r[0]||(r[0]=M(N=>v.value=!1,["prevent"])),onDragover:r[1]||(r[1]=M(()=>{},["prevent"])),class:"w-full h-full absolute"},null,32)):S("",!0),f(ue,{class:V([{"text-stone-700":!v.value,"text-cyan-500":v.value},"!w-16 !h-16 mx-auto mb-xs transition-colors ease-in-out duration-200"])},null,8,["class"]),he,C("div",ye,q(e(c).join(", ")),1)]),x.value?(s(),U(de,{key:0,size:"xl",class:"rounded-lg"})):S("",!0)],42,ge),C("input",{ref_key:"input",ref:_,id:"browse",type:"file",accept:e(c).join(","),multiple:"multiple",class:"hidden",onChange:w},null,40,xe),e(g).length?(s(),m("div",be,[f(J,{items:e(g),columns:l.columns},{default:d(({item:N})=>[f(L,{active:l.isSelected(N.media),onClick:K=>l.toggleSelect(N.media)},{default:d(()=>[f(E,{media:N.media},null,8,["media"])]),_:2},1032,["active","onClick"])]),_:1},8,["items","columns"])])):S("",!0)],64))}},we={},$e={class:"w-full text-lg"};function Se(l,a){return s(),m("div",$e,[A(l.$slots,"default")])}const Ce=X(we,[["render",Se]]),Ie=D("Library"),Ze={__name:"MediaUploads",props:{columns:{type:Number,default:3}},setup(l,{expose:a}){const{page:o,items:c,endlessPagination:_,selected:v,toggleSelect:h,deselectAll:w,removeItems:k,isSelected:x,createObserver:n}=W();return j(()=>{n()}),a({selected:v,deselectAll:w,removeItems:k}),(p,u)=>(s(),m(P,null,[f(ke,{"max-selection":4,"combines-mime-types":"",selected:e(v),toggleSelect:e(h),isSelected:e(x),columns:l.columns},null,8,["selected","toggleSelect","isSelected","columns"]),C("div",{class:V({"mt-lg":e(c).length})},[e(c).length?(s(),m(P,{key:0},[f(Ce,{class:"mb-4"},{default:d(()=>[Ie]),_:1}),f(J,{items:e(c),columns:l.columns},{default:d(({item:I})=>[I?(s(),U(L,{key:0,active:e(x)(I),onClick:$=>e(h)(I)},{default:d(()=>[f(E,{media:I},null,8,["media"])]),_:2},1032,["active","onClick"])):S("",!0)]),_:1},8,["items","columns"])],64)):S("",!0),C("div",{ref_key:"endlessPagination",ref:_,class:"-z-10 w-full"},null,512)],2)],64))}},Ne={},De={class:"absolute z-10 bottom-0 mb-xs left-0 ml-xs hidden group-hover:block"},Pe={class:"bg-white shadow-mix py-xs px-sm text-left rounded-md"};function Te(l,a){return s(),m("div",De,[C("div",Pe,[A(l.$slots,"default")])])}const oe=X(Ne,[["render",Te]]),Ue={key:0},Fe={key:0,class:"mt-lg"},Me=C("div",null,"Image from Unsplash",-1),Ve=D("By "),ze=["href"],Oe=D("No images found."),je=D(" You have not configured Unsplash service. "),Ae=D("Click to configure"),et={__name:"MediaStock",props:{columns:{type:Number,default:3}},setup(l,{expose:a}){const o=O(()=>H().props.has_service.unsplash),{isLoaded:c,keyword:_,page:v,items:h,endlessPagination:w,selected:k,toggleSelect:x,deselectAll:n,isSelected:p,createObserver:u}=W("mixpost.media.fetchStock");return j(()=>{o.value&&u()}),a({selected:k,deselectAll:n}),(I,$)=>(s(),m(P,null,[e(o)?(s(),m("div",Ue,[f(se,{modelValue:e(_),"onUpdate:modelValue":$[0]||($[0]=i=>Z(_)?_.value=i:null),placeholder:"Search Unsplash"},null,8,["modelValue"]),e(h).length?(s(),m("div",Fe,[f(J,{items:e(h),columns:l.columns},{default:d(({item:i})=>[i?(s(),U(L,{key:0,active:e(p)(i),onClick:F=>e(x)(i)},{default:d(()=>[f(E,{media:i,class:"group"},{default:d(()=>[f(oe,null,{default:d(()=>[Me,C("div",null,[Ve,C("a",{href:i.credit_url,target:"_blank",class:"link"},q(i.name),9,ze)])]),_:2},1024)]),_:2},1032,["media"])]),_:2},1032,["active","onClick"])):S("",!0)]),_:1},8,["items","columns"])])):S("",!0),e(c)&&!e(h).length?(s(),U(te,{key:1,class:"mt-lg"},{default:d(()=>[Oe]),_:1})):S("",!0),C("div",{ref_key:"endlessPagination",ref:w,class:"-z-10 w-full"},null,512)])):S("",!0),e(o)?S("",!0):(s(),m(P,{key:1},[f(le,{variant:"warning",closeable:!1},{default:d(()=>[je]),_:1}),f(e(ee),{href:I.route("mixpost.services.index"),class:"block mt-md"},{default:d(()=>[f(ne,null,{default:d(()=>[Ae]),_:1})]),_:1},8,["href"])],64))],64))}},Ee={key:0},Je={key:0,class:"mt-lg"},Le=D(" GIF from Tenor "),Be=D("No GIFs found."),Ge=D(" You have not configured Tenor service. "),Re=D("Click to configure"),tt={__name:"MediaGifs",props:{columns:{type:Number,default:3}},setup(l,{expose:a}){const o=O(()=>H().props.has_service.tenor),{isLoaded:c,keyword:_,page:v,items:h,endlessPagination:w,selected:k,toggleSelect:x,deselectAll:n,isSelected:p,createObserver:u}=W("mixpost.media.fetchGifs");return j(()=>{o.value&&u()}),a({selected:k,deselectAll:n}),(I,$)=>(s(),m(P,null,[e(o)?(s(),m("div",Ee,[f(se,{modelValue:e(_),"onUpdate:modelValue":$[0]||($[0]=i=>Z(_)?_.value=i:null),placeholder:"Search Tenor GIFs"},null,8,["modelValue"]),e(h).length?(s(),m("div",Je,[f(J,{items:e(h),columns:l.columns},{default:d(({item:i})=>[i?(s(),U(L,{key:0,active:e(p)(i),onClick:F=>e(x)(i)},{default:d(()=>[(s(),U(E,{media:i,key:i.id,class:"group"},{default:d(()=>[f(oe,null,{default:d(()=>[Le]),_:1})]),_:2},1032,["media"]))]),_:2},1032,["active","onClick"])):S("",!0)]),_:1},8,["items","columns"])])):S("",!0),e(c)&&!e(h).length?(s(),U(te,{key:1,class:"mt-lg"},{default:d(()=>[Be]),_:1})):S("",!0),C("div",{ref_key:"endlessPagination",ref:w,class:"-z-10 w-full"},null,512)])):S("",!0),e(o)?S("",!0):(s(),m(P,{key:1},[f(le,{variant:"warning",closeable:!1},{default:d(()=>[Ge]),_:1}),f(e(ee),{href:I.route("mixpost.services.index"),class:"block mt-md"},{default:d(()=>[f(ne,null,{default:d(()=>[Re]),_:1})]),_:1},8,["href"])],64))],64))}};export{Ze as _,et as a,tt as b,W as u};
