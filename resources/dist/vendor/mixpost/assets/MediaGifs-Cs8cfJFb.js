import{r as h,j as P,D as Y,L as T,a_ as re,H as E,b9 as ie,c as p,o as a,F as D,e as X,b as k,A as L,d as I,t as q,n as U,g as A,f as $,ci as ue,c3 as j,a as v,c1 as M,c7 as ce,u as o,w as f,h as Z,B as ee,_ as te,i as se}from"./app-DmGdsn2l.js";import{_ as O}from"./MediaFile-DnxkfaQ3.js";import{_ as de,a as le}from"./SearchInput-2feBWL8w.js";import{l as Q,o as me}from"./helpers-DK6GMq_y.js";import{_ as ne}from"./NoResult-C9KF7zEB.js";import{_ as ae}from"./Alert-CiPY5W6k.js";import{u as fe}from"./useNotifications-DtxXR9Gv.js";const W=(n="mixpost.media.fetchUploads",c={})=>{const{notify:i}=fe(),d=h("uploads"),x=P(()=>({uploads:"Upload",stock:"Stock Photos",gifs:"GIFs"})),r=h(!1),w=h(!1),C=h(!1),b=h(1),m=h([]),u=h(null),_=h(""),s=h([]),g=y=>{const e=s.value.findIndex(t=>t.id===y.id);e<0&&!y.hasOwnProperty("error")&&s.value.push(y),e>=0&&s.value.splice(e,1)},l=()=>{s.value=[]},S=y=>s.value.findIndex(t=>t.id===y.id)!==-1,F=(y=!0)=>{b.value&&(T.start(),axios.get(route(n,c),{params:{page:b.value,keyword:_.value}}).then(function(e){const t=e.data.links.next;t&&(b.value=e.data.links.next.split("?page=")[1]),t||(b.value=0),y||(m.value=e.data.data),y&&(m.value=[...m.value,...e.data.data])}).catch(()=>{i("error","Error retrieving media. Try again!")}).finally(()=>{T.done(),r.value=!0}))},J=(y,e)=>{w.value=!0,T.start(),axios.post(route("mixpost.media.download",c),{items:y,from:d.value}).then(t=>{e(t)}).catch(()=>{i("error","Error downloading media. Try again!")}).finally(()=>{w.value=!1,T.done(),T.remove()})},G=y=>{m.value=m.value.filter(e=>!y.includes(e.id))},V=(y,e)=>{C.value=!0,T.start(),axios.delete(route("mixpost.media.delete",c),{data:{items:y}}).then(()=>{e()}).catch(()=>{i("error","Error deleting media. Try again!")}).finally(()=>{C.value=!1,T.done(),T.remove()})},R=()=>{const y=new IntersectionObserver(e=>{e[0].isIntersecting&&F()});re(()=>{y.observe(u.value)})};return Y(_,Q.debounce(()=>{b.value=1,F(!1)},300)),{activeTab:d,tabs:x,isLoaded:r,isDownloading:w,isDeleting:C,keyword:_,page:b,items:m,endlessPagination:u,selected:s,downloadExternal:J,deletePermanently:V,removeItems:G,createObserver:R,toggleSelect:g,deselectAll:l,isSelected:S}},ve="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let pe=(n=21)=>{let c="",i=crypto.getRandomValues(new Uint8Array(n|=0));for(;n--;)c+=ve[i[n]&63];return c};const ge=["data-column"],B={__name:"Masonry",props:{items:{type:Array,required:!0},columns:{type:Number,default:3}},setup(n){const c=n,i=h(null),d=h([]),x=h(!1);E(()=>{m(),window.addEventListener("resize",r)}),ie(()=>{window.removeEventListener("resize",r)});const r=Q.debounce(()=>{d.value.length!==w().length&&m()},300),w=()=>{let u=c.columns;me().width<=768&&(u=2);const _=[];for(let s=0;s<u;s++)_.push({i:s,indexes:[]});return _},C=u=>{const _=u%d.value.length;d.value[_].indexes.push(u)},b=()=>{for(let u=0;u<c.items.length;u++)C(u)},m=()=>{x.value=!1,d.value.splice(0),d.value.push(...w()),x.value=!0,b()};return Y(()=>c.items,()=>{m()}),(u,_)=>(a(),p("div",{class:U(["flex -m-1",{"opacity-0":!x.value}])},[(a(!0),p(D,null,X(d.value,(s,g)=>(a(),p("div",{class:"flex flex-col grow basis-0 px-1",key:g},[(a(!0),p(D,null,X(s.indexes,l=>(a(),p("div",{class:"py-1",key:l,ref_for:!0,ref:`item_${l}`},[L(u.$slots,"default",{item:n.items[l],index:l},()=>[I(q(n.items[l]),1)])]))),128)),k("div",{class:"grow -mt-20 pt-20 min-h-[100px] -z-10",ref_for:!0,ref_key:"bottomRef",ref:i,"data-column":g},null,8,ge)]))),128))],2))}},z={__name:"MediaSelectable",props:{active:{type:Boolean,default:!1}},emits:["click"],setup(n){return(c,i)=>(a(),p("div",{onClick:i[0]||(i[0]=d=>c.$emit("click")),class:"w-full relative cursor-pointer box-border"},[L(c.$slots,"default"),k("div",{class:U(["absolute flex items-center justify-center top-0 right-0 mr-sm mt-sm w-7 h-7 rounded-full border border-white",{"bg-indigo-500":n.active,"bg-black/20":!n.active}])},[n.active?(a(),A(ue,{key:0,class:"text-white"})):$("",!0)],2)]))}},_e={class:"relative flex flex-col justify-center"},ye={class:"text-sm text-gray-400 text-center"},he=["accept"],be={key:0,class:"mt-lg"},xe={__name:"UploadMedia",props:{maxSelection:{type:Number,default:1},combinesMimeTypes:{type:String,default:""},selected:{type:Array,default:[]},toggleSelect:{type:Function},isSelected:{type:Function},columns:{type:Number,default:3}},emits:["mediaSelect"],setup(n,{emit:c}){const i=n,d=j().props.mixpost.mime_types,x=h(null),r=h(!1),w=e=>{if(m.value)return;r.value=!1;const t=b(e.dataTransfer.files);t.length&&V(t)},C=e=>{const t=b(e.target.files);t.length&&(x.value.value=null,V(t))},b=e=>Array.from(e).filter(t=>d.includes(t.type)),m=h(!1),u=h([]),_=h([]),s=h({});Y(s,()=>{g(),m.value=Object.keys(s.value).length>0});const g=()=>{s.value.handler&&s.value.handler()},l=e=>{u.value.push(e),Object.keys(s.value).length===0&&S()},S=e=>{Object.keys(s.value).length>0&&(G(s.value,e),i.toggleSelect&&i.toggleSelect(e)),u.value.length>0?(F(u.value[0]),J()):F({})},F=e=>{s.value=e},J=()=>{u.value.shift()},G=(e,t)=>{_.value.push(Object.assign(e,{media:t}))},V=e=>{e.forEach(t=>{l({id:pe(),handler:async()=>{await R(t).then(N=>{S(N)}).catch(N=>{S({name:t.name,error:N.response.data.message})})}})})},R=e=>{const t=new FormData;return t.append("file",e),new Promise((N,K)=>{axios.post(route("mixpost.media.upload"),t).then(function(H){N(H.data)}).catch(function(H){K(H)})})},y=P(()=>_.value.filter(()=>!0).reverse());return h([]),(e,t)=>(a(),p(D,null,[k("div",{onDragenter:t[2]||(t[2]=M(N=>r.value=!m.value,["prevent"])),onDrop:M(w,["prevent"]),onDragover:t[3]||(t[3]=M(()=>{},["prevent"])),class:U([{"border-gray-700 bg-white":!r.value,"border-cyan-500 bg-cyan-50":r.value},"relative w-full flex items-center justify-center rounded-lg p-10 border-2 border-dashed transition-colors ease-in-out duration-200"])},[k("div",_e,[r.value?(a(),p("div",{key:0,onDragleave:t[0]||(t[0]=M(N=>r.value=!1,["prevent"])),onDragover:t[1]||(t[1]=M(()=>{},["prevent"])),class:"w-full h-full absolute"},null,32)):$("",!0),v(ce,{class:U([{"text-stone-700":!r.value,"text-cyan-500":r.value},"w-16! h-16! mx-auto mb-xs transition-colors ease-in-out duration-200"])},null,8,["class"]),t[4]||(t[4]=k("div",{class:"text-center mb-1"},[I("Drag & drop files here, or "),k("label",{for:"browse",class:"cursor-pointer text-indigo-500 hover:text-indigo-700 active:text-indigo-700 focus:outline-hidden focus:text-indigo-700 transition-colors ease-in-out duration-200"}," Browse ")],-1)),k("div",ye,q(o(d).join(", ")),1)]),m.value?(a(),A(de,{key:0,size:"xl",class:"rounded-lg"})):$("",!0)],34),k("input",{ref_key:"input",ref:x,id:"browse",type:"file",accept:o(d).join(","),multiple:"multiple",class:"hidden",onChange:C},null,40,he),y.value.length?(a(),p("div",be,[v(B,{items:y.value,columns:n.columns},{default:f(({item:N})=>[v(z,{active:n.isSelected(N.media),onClick:K=>n.toggleSelect(N.media)},{default:f(()=>[v(O,{media:N.media},null,8,["media"])]),_:2},1032,["active","onClick"])]),_:1},8,["items","columns"])])):$("",!0)],64))}},ke={},we={class:"w-full text-lg"};function $e(n,c){return a(),p("div",we,[L(n.$slots,"default")])}const Se=Z(ke,[["render",$e]]),Je={__name:"MediaUploads",props:{columns:{type:Number,default:3}},setup(n,{expose:c}){const{items:i,endlessPagination:d,selected:x,toggleSelect:r,deselectAll:w,removeItems:C,isSelected:b,createObserver:m}=W();return E(()=>{m()}),c({selected:x,deselectAll:w,removeItems:C}),(u,_)=>(a(),p(D,null,[v(xe,{"max-selection":4,"combines-mime-types":"",selected:o(x),toggleSelect:o(r),isSelected:o(b),columns:n.columns},null,8,["selected","toggleSelect","isSelected","columns"]),k("div",{class:U({"mt-lg":o(i).length})},[o(i).length?(a(),p(D,{key:0},[v(Se,{class:"mb-4"},{default:f(()=>_[0]||(_[0]=[I("Library")])),_:1,__:[0]}),v(B,{items:o(i),columns:n.columns},{default:f(({item:s})=>[s?(a(),A(z,{key:0,active:o(b)(s),onClick:g=>o(r)(s)},{default:f(()=>[v(O,{media:s},null,8,["media"])]),_:2},1032,["active","onClick"])):$("",!0)]),_:1},8,["items","columns"])],64)):$("",!0),k("div",{ref_key:"endlessPagination",ref:d,class:"-z-10 w-full"},null,512)],2)],64))}},Ce={},Ie={class:"absolute z-10 bottom-0 mb-xs left-0 ml-xs hidden group-hover:block shadow-mix"},Ne={class:"bg-white shadow-mix py-xs px-sm text-left rounded-md"};function De(n,c){return a(),p("div",Ie,[k("div",Ne,[L(n.$slots,"default")])])}const oe=Z(Ce,[["render",De]]),Te={key:0},Ae={key:0,class:"mt-lg"},Fe=["href"],Me=["href"],Ge={__name:"MediaStock",props:{columns:{type:Number,default:3}},setup(n,{expose:c}){const i=P(()=>Q.snakeCase(j().props.app.name)),d=P(()=>j().props.is_configured_service.unsplash),{isLoaded:x,keyword:r,items:w,endlessPagination:C,selected:b,toggleSelect:m,deselectAll:u,isSelected:_,createObserver:s}=W("mixpost.media.fetchStock");return E(()=>{d.value&&s()}),c({selected:b,deselectAll:u}),(g,l)=>(a(),p(D,null,[d.value?(a(),p("div",Te,[v(le,{modelValue:o(r),"onUpdate:modelValue":l[0]||(l[0]=S=>ee(r)?r.value=S:null),placeholder:"Search Unsplash"},null,8,["modelValue"]),o(w).length?(a(),p("div",Ae,[v(B,{items:o(w),columns:n.columns},{default:f(({item:S})=>[S?(a(),A(z,{key:0,active:o(_)(S),onClick:F=>o(m)(S)},{default:f(()=>[v(O,{media:S,class:"group"},{default:f(()=>[v(oe,null,{default:f(()=>[k("div",null,[l[1]||(l[1]=I("Image from ")),k("a",{href:`https://unsplash.com/?utm_source=${i.value}&utm_medium=referral`,target:"_blank",class:"link"},"Unsplash",8,Fe)]),k("div",null,[l[2]||(l[2]=I("By ")),k("a",{href:`${S.credit_url}?utm_source=${i.value}&utm_medium=referral`,target:"_blank",class:"link"},q(S.name),9,Me)])]),_:2},1024)]),_:2},1032,["media"])]),_:2},1032,["active","onClick"])):$("",!0)]),_:1},8,["items","columns"])])):$("",!0),o(x)&&!o(w).length?(a(),A(ne,{key:1,class:"mt-lg"},{default:f(()=>l[3]||(l[3]=[I("No images found.")])),_:1,__:[3]})):$("",!0),k("div",{ref_key:"endlessPagination",ref:C,class:"-z-10 w-full"},null,512)])):$("",!0),d.value?$("",!0):(a(),p(D,{key:1},[v(ae,{variant:"warning",closeable:!1},{default:f(()=>l[4]||(l[4]=[I(" You have not configured Unsplash service. ")])),_:1,__:[4]}),v(o(se),{href:g.route("mixpost.services.index"),class:"block mt-md"},{default:f(()=>[v(te,null,{default:f(()=>l[5]||(l[5]=[I("Click to configure")])),_:1,__:[5]})]),_:1},8,["href"])],64))],64))}},Pe={key:0},Ue={key:0,class:"mt-lg"},Re={__name:"MediaGifs",props:{columns:{type:Number,default:3}},setup(n,{expose:c}){const i=P(()=>j().props.is_configured_service.tenor),{isLoaded:d,keyword:x,items:r,endlessPagination:w,selected:C,toggleSelect:b,deselectAll:m,isSelected:u,createObserver:_}=W("mixpost.media.fetchGifs");return E(()=>{i.value&&_()}),c({selected:C,deselectAll:m}),(s,g)=>(a(),p(D,null,[i.value?(a(),p("div",Pe,[v(le,{modelValue:o(x),"onUpdate:modelValue":g[0]||(g[0]=l=>ee(x)?x.value=l:null),placeholder:"Search Tenor GIFs"},null,8,["modelValue"]),o(r).length?(a(),p("div",Ue,[v(B,{items:o(r),columns:n.columns},{default:f(({item:l})=>[l?(a(),A(z,{key:0,active:o(u)(l),onClick:S=>o(b)(l)},{default:f(()=>[(a(),A(O,{media:l,key:l.id,class:"group"},{default:f(()=>[v(oe,null,{default:f(()=>g[1]||(g[1]=[I(" GIF from Tenor ")])),_:1,__:[1]})]),_:2},1032,["media"]))]),_:2},1032,["active","onClick"])):$("",!0)]),_:1},8,["items","columns"])])):$("",!0),o(d)&&!o(r).length?(a(),A(ne,{key:1,class:"mt-lg"},{default:f(()=>g[2]||(g[2]=[I("No GIFs found.")])),_:1,__:[2]})):$("",!0),k("div",{ref_key:"endlessPagination",ref:w,class:"-z-10 w-full"},null,512)])):$("",!0),i.value?$("",!0):(a(),p(D,{key:1},[v(ae,{variant:"warning",closeable:!1},{default:f(()=>g[3]||(g[3]=[I(" You have not configured Tenor service. ")])),_:1,__:[3]}),v(o(se),{href:s.route("mixpost.services.index"),class:"block mt-md"},{default:f(()=>[v(te,null,{default:f(()=>g[4]||(g[4]=[I("Click to configure")])),_:1,__:[4]})]),_:1},8,["href"])],64))],64))}};export{Re as _,Ge as a,Je as b,W as u};
